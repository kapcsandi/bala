<% form_for 'q', :url => houses_path, :html => { :method => :get }  do |f| %>
  <div class="span-3 label"><%= t :city %></div>
  <div class="span-5 last field">
  <%= select_tag 'place', Taggable.find_by_field('city_id').tags.map{|tag| 
    if params[:place] == tag.id.to_s
      '<option selected value="' + tag.id.to_s + '">' + tag.name + '</option>'
    else
      '<option value="' + tag.id.to_s + '">' + tag.name + '</option>'
    end
  } 
  %>
  </div>
  <div class="span-3 label"><%= t :persons %></div>
  <div class="span-5 last field">
  <% p_o = ''
  (1..15).each do |item|
    p_o += '<option'
    p_o += ' selected' if params[:persons_gte].to_i == item or (item==2 and not params[:persons_gte])
    p_o += ' value="'+item.to_s+'">'+item.to_s+'</option>'
  end
  %>
  <%= select_tag :persons_gte, p_o %>
  </div>
  <div class="span-3 label"><%= t :date_from %></div>
  <div class="span-5 last field">
  <%= calendar_date_select 'q', 'from', :order => [:year, :month, :day], :size=> 15, :value => params[:q] ? params[:q][:from] : '' %>
  </div>
  <div class="span-3 label"><%= t :date_to %></div>
  <div class="span-5 last field">
  <%= calendar_date_select 'q', 'to', :order => [:year, :month, :day], :size=> 15, :value => params[:q] ? params[:q][:to] : '' %>
  </div>
  <div class="span-3 label"><%= t :code %></div>
  <div class="span-5 last field">
  <%= f.text_field :code_like, :size=> 15, :value => params[:search] ? params[:q][:code_like] : '' %>
  </div>
  <hr />
  <div class="span-3 label"><%= t :house_type_id %></div>
  <div class="span-5 last field">
  <%= select_tag 'type', Taggable.find_by_field('house_type_id').tags.map{|tag| 
    if params[:type] == tag.id.to_s
      '<option selected value="' + tag.id.to_s + '">' + tag.name + '</option>'
    else
      '<option value="' + tag.id.to_s + '">' + tag.name + '</option>'
    end
  } 
  %>
  </div>
  <div class="span-3 label"><%= t :rooms %></div>
  <div class="span-5 last field">
  <% p_o = ''
  (1..6).each do |item|
    p_o += '<option'
    p_o += ' selected' if params[:rooms_gte].to_i == item or (item==1 and not params[:rooms_gte])
    p_o += ' value="'+item.to_s+'">'+item.to_s+'</option>'
  end
  %>
  <%= select_tag :rooms_gte, p_o %>
  </div>
  <fieldgroup>
    <div class="span-2 label"><%= t :sat %></div>
    <div class="span-1 last field">
    <%= check_box_tag 'sat', 1, params[:sat] == '1' %>
    </div>
    <div class="span-2 label"><%= t :clima_id %></div>
    <div class="span-1 last field">
    <%= check_box_tag 'clima', 1, params[:clima] == '1' %>
    </div>
    <div class="span-2 label"><%= t :internet %></div>
    <div class="span-1 last field">
    <%= check_box_tag 'internet', 1, params[:internet] == '1'  %>
    </div>
    <div class="span-2 label"><%= t :pool %></div>
    <div class="span-1 last field">
    <%= check_box_tag 'pool', 1, params[:pool] == '1' %>
    </div>
    <div class="span-2 label"><%= t :grill %></div>
    <div class="span-1 last field">
    <%= check_box_tag 'grill', 1, params[:grill] == '1' %>
    </div>
  </fieldgroup>
  <div class="prepend-15 span-3">
  <% if params[:advanced] %>
  <input type="hidden" name="advanced" value="<%= params[:advanced] %>">
  <% end %>
  <%= submit_tag t :search %><br />
  <%= link_to  t(:simple_search), url_for(:controller => 'houses', :action => 'index', :advanced => '0'), :method => :get  %>
  </div>
<% end %>