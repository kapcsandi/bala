<%- if controller.action_name != 'print' %>
<a name="details"></a>
<% end -%>
<% title ([@house.house_type, @house.code, @house.city].join(', ') ), false %>
<div class="inner">
<div class="mini odd">
<%= render :partial => 'mini', :locals => { :house => @house, :cart => @cart } %>
<%- unless controller.action_name == 'print' %>
<%= render :partial => 'navigation' , :locals => { :house => @house }%>
<% end -%>
</div>
<% field_set_tag t('house_basics') do %>
  <% content_tag :div, :id => :house_basics do %>
    <%- field = Taggable.find_by_position(6)
     tagnames = [] -%>
    <p><%= label :house, field.name %>:
      <%- for tag in field.tags do
        tagnames << tag.name if @house.tags.include?(tag)
       end -%>
      <%= tagnames.to_sentence -%>
    </p>
    <%- if @house.discounted? %>
    <p>
      <%= h @house.discount.description %>
    </p>
    <% end -%>
    <%- if admin? %>
    <div class="admin">
      <%= label_tag t(:admin_description) %>:<br />
      <%= h @house.admin_description %>
    </div>
    <% end -%>
    <%- unless @house.house_description.empty? -%>
    <p>
      <%= label_tag t(:house_description) %>:<br />
      <%= @house.house_description %>
    </p>
    <%- end -%>
    <%- if admin?
      field = Taggable.find_by_position(80)
       tagnames = []
       for tag in field.tags do tagnames << tag.name if @house.tags.include?(tag) end -%>
      <p><%= label_tag field.name %>:  <%= unless tagnames.empty? then tagnames.join(', ') else t('house_not_in_any_group') end -%></p>
    <%- end -%>
  <%- end -%>
<%- end -%>
<%- field_set_tag t('house_rooms'), :class => 'odd' do %>
  <% content_tag :div, :id => :house_rooms do %>
    <%- for field in Taggable.find_all_by_position([8, 9, 10, 11])
      tagnames = []
      for tag in field.tags do tagnames << tag.name if @house.tags.include?(tag) and tag.name != t('nincs')  end -%>
      <%- unless tagnames.empty? -%>
        <p>
        <%= label_tag field.name %>:
        <%= tagnames.to_sentence -%>
        </p>
      <%- end -%>
    <%- end -%>
    <%- for field in %w(living_room_sq living_dining_room_sq kitchen_sq dining_room_sq kitchen_dining_room_sq terrace_sq balcony_sq yard_sq) -%>
      <%- unless @house[field].nil? or @house[field] == '0' -%>
      <p>
        <%= label_tag t(field) %>:
        <%=h @house[field].split(';').to_sentence %> <%= t(:sqmeter) -%>
      </p>
      <%- end -%>
    <%- end -%>
    <%- for field in %w(bedroom living_room living_dining_room kitchen dining_room kitchen_dining_room balcony) -%>
      <%- unless @house[field].nil? or @house[field]<2 -%>
      <p>
        <%= label_tag t(field) %>:
        <%=h @house[field] %> <%= t(:items) %>
      </p>
      <%- end -%>
    <%- end -%>
    <p>
      <%= label_tag t(:terrace_id) %>: <%=h @house.terrace -%>
    </p>
    <%- if @house.garden? -%>
    <p>
      <%= label_tag t(:garden) %>: <%= check_box_tag @house.garden, 1, @house.garden?, :disabled => true -%>
    </p>
    <%- end -%>
  <%- end -%>
<%- end -%>
<% field_set_tag nil, :class => 'fullwidth' do %>
  <div id="house_beds">
  <p><label><%= t('house_beds') %>:</label>
  <%- beds = []
  for field in %w(double_bed single_bed extra_bed pull_out_bed)
    unless @house[field].nil? or @house[field] == 0
      beds << @house[field].to_s + ' ' + t(field)
    end
  end %><%= beds.to_sentence %></p>
  <p><label><%= t('house_bathrooms') %>:</label>
  <% baden = []; baden << @house.bathrooms.to_s + ' ' + t(:bathrooms)
  for field in %w(shower bathtub)
    if @house[field]==1
      baden <<  t(field)
    end
  end
  baden << @house.wcs.to_s + ' ' + t(:wcs)
  if @house.wc_separated==1
    baden << t(:wc_separated)
  end %><%= baden.to_sentence %></p><br class="clear"/>
  <p><label><%= t('house_kitchen') -%>:</label>
  <%-
  fields = []
  for field in %w(fridge coffee_machine micro) do
     fields << @house[field].to_s + ' ' + t(field) if @house[field]>0
  end %><%= fields.to_sentence %></p>
  <p><%= label_tag t(:stove_id) %>: <%= @house.stove %></p>
<br class="clear"/>
  <p><label><%= t('house_inters') %>:</label>
  <%-
  fields = []
  fields << @house[:sat].to_s + ' ' + t(:sat) if @house[:sat] > 0
  fields << t(:internet) if @house[:internet] == 1
   -%><%= fields.to_sentence %></p>
  <%- if @house.clima !~ /-|nincs/ %>
  <p><%= label_tag t(:clima_id) %>: <%= @house.clima %></p>
  <% end %>
  <p><label><%= t('house_outers') %>:</label>
  <%- if @house.pool? -%>
  <p><%= label_tag t(:pool) %>: <%= check_box_tag :pool, 1, @house.pool?, :disabled => true %></p>
  <div id="pool_sq"<%= "style='display:none'" unless @house.pool? %>>
    <p><%= label_tag t(:pool_sq) %>: <%=h @house.pool_sq %> <%= t(:sqmeter) %></p>
  </div>
  <%- end -%>
  <%-
  fields = []
  for field in %w(garden_seats grill sunbath_seat playground) do
    if field == "sunbath_seat"
      fields << @house[field].to_s + ' ' + t(field) if @house[field]>1
    else
      fields << t(field) if @house[field]==1
    end
  end -%>
  <%= fields.to_sentence %></p>
  <p><%= label_tag t(:parking_id) %>: <%= @house.parking %></p>
</div>
<% end %>
<% field_set_tag t('house_distances'), :class => 'full odd' do %>
  <% content_tag :div, :id => 'house_distances' do %>
    <% %w{center beach aquapark shop station medical mainroad restaurant}.each do |item| %>
    <p>
      <span class="label"><%= label_tag t("distance_#{item}") %>:</span>
      <span><%= t('meters', :d => @house.distance(item)) %></span>
    </p>
    <%end %>
  <% end %>
<% end %>
<% field_set_tag t('house_owner_infos') do %>
    <% field = Taggable.find_by_position(61)
    tagnames = [] %>
    <% for tag in field.tags %>
      <% tagnames << tag.name if @house.tags.include?(tag) %>
    <% end %>
    <% unless tagnames.empty? %>
    <p>
      <%= label_tag field.name %>:
      <%= tagnames.join(', ') %>
    </p>
    <% end %>
    <p>
      <%= label_tag t(:owner_place_id) %>:
      <%= @house.owner_place %>
    </p>
  <% end %>
  <% field_set_tag t('animals'), :class => 'odd fullwidth' do %>
    <p>
      <%= label_tag t(:animals) %>:
      <%= @house.animals? ? t('yes_animals') : t('no_animals') %>
    </p>
    <p<%= " style='display:none'" unless @house.animals? %>>
      <%= label_tag t(:animal_charge) %>:
      <%= @house.animal_charge == 1 ? t('answer_yes') : t('answer_no') %>
    </p>
  <% end %>
<% field_set_tag t('house_prices') do %>
<% content_tag :div, :id => :house_prices do %>
  <p style="width:100%">Mietpreis pro Haus und Woche in Euro</p>
  <br />
  <table class="full">
  <thead>
  <tr>
  <th> von </th>
  <th> bis </th>
  <th> bei Belegung mit .. Personen</th>
  <th>bis zu </th>
  <th> Mietpreis </th>
  </tr>
  </thead>
  <tbody>
  <% for season in Season.next_year %>
    <tr class=<%= cycle('odd', 'even') %>>
    <td><%=l(season.start) %></td>
    <td><%=l(season.end) %></td>
    <td><%= @house.persons %></td>
    <td><%= t(season.name) %></td>
    <td><%=h @house.price(season.name) %> EUR</td>
    </tr>
  <% end %>
  </tbody>
  </table>
  <% end %>
  <% end %>
  <% field_set_tag 'Mietbedienungen', :class => 'odd' do %>
  <p>
  Im Preis bereits enthalten: Battwäsche, Endreinigung, Gas, Strom, Wasser.<br />
  Nebenkosten: Zuschläge (zalhbar bei Buchung): Ortstaxe<br />
  An- und Abreise: Samstags. Mindestanfenhalt 1 Woche. Abweichende An- und
  Abreise sowie kürzere Afenthalte in der Nebensaison auf Anfrage möglich (teilweise
  Mietpreiszuschlag)
  </p>
<% end %>
<% if controller.action_name != 'print' %>
  <a name="photos"></a>
<% end %>
<% field_set_tag t('pictures'), :class => 'photos' do %>
  <% content_tag :div, :id => :pictures do %>
    <% if @house.picture_ids.respond_to?('index')
      @house.picture_urls('m').each_with_index do |id,index| %>
        <% link_to_lightbox2 id.sub(/_m/,'_l'), :group => @house.code, :title => "#{@house.code} ##{index+1}" do %>
          <%= image_tag id %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
  
<% if admin? %>
<p>
  <%= link_to t('admin.edit'), edit_house_path(@house) %> |
  <%= link_to t('admin.destroy'), @house, :confirm => t('admin.are_you_sure'), :method => :delete %> |
  <%= link_to t('admin.view_all'), houses_path %>
</p>
<% end %>
</div>